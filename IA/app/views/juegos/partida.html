
{% extends "layouts/layout.html" %}

{% block CONTENT %}

<div class="wrapper text-center">
    <div class="container">
    	<h1>{{nombre}}</h1>
    	<h4 id= "msnje"> </h4>
        <div id="tablero" class="text-center"></div>
    </div>
</div>

{% endblock %}

{% block SCRIPT %}


<script type="text/javascript">
    console.log('marca ');
	window.onload = function() {
	    socket.emit("data", '{"command": "ROUND_START_ACK","arguments": {"id": "'+id+'"}}');
	    inicio = true;
	    var mensaje = document.getElementById("msnje"); 
		mensaje.innerHTML = "COMENZANDO PARTIDA";
	}
	var id = "{{id}}";
	this.color; // true representa player1 y color blanco 
	this.inicio; //indica si el juego ya partio
	this.turno;   //indica si corresponde comenzar el juego
	this.tablero = new Tablero();
    tablero.crear_tablero_html( 'tablero' ,  {{tamTablero}} , new Array({{squares}}) );
    
    function colocarFicha(fila,columna,colorDeFicha){
    	// colorDeFicha true es blanco
    	// colorDeFicha false es negro
    	content = document.getElementById("tablero_id_"+fila+columna); 
		var div = document.createElement("div");
		if(colorDeFicha) div.className = "circulo_blanco";
		else div.className = "circulo_negro";
        content.appendChild(div);
        content.setAttribute('onclick',null);
    }
    function jugarFicha(fil,col){
    	if(inicio){
	    	if(turno){
	    		//turno = false;
				content = document.getElementById(("tablero_id_"+ fil + col)); 
                console.log(content);
				colocarFicha( fil, col, color);
				turno = false;
            //    socket.emit("data", '{"command": "PUT","arguments": {"id": "'+id+'", "xPos": '+fil+',
   // "yPos": '+col+'}}');

    socket.emit("data", '{"command": "PUT","arguments": {"id": "'+id+'","xPos": "'+fil+'","yPos":"'+col+'" }}');

	    	}else{
	    		var mensaje = document.getElementById("msnje"); 
				mensaje.innerHTML = "Debes esperar tu turno";
	    	}
    	}else {
    		var mensaje = document.getElementById("msnje"); 
			mensaje.innerHTML = "El juego comenzar√° pronto";
		}
	}
    function partida(data2){
        data = arguments.advMove;
    	switch(data.move){
    		case 'FIRST':
    			color = true;
    			turno = true;
    			var mensaje = document.getElementById("msnje"); 
				mensaje.innerHTML = "SU TURNO";
    			break;
    		case 'WAIT':
    			color = false;
    			turno = false;
    			var mensaje = document.getElementById("msnje"); 
				mensaje.innerHTML = "ESPERE SU TURNO";
                break;
    		case 'PUT':
                if(data2.arguments.yourTurn){
                    jugarFicha(data.xPos, data.yPos, !turno);
                    turno = true;
                } 
                else{
                    alert('alerta no entregada');
                    turn = false;
                }
    			break;
    		case 'PASS':
    			alert('no implementado');
    			break;
    		case 'default':
    			alert('no implementado');
    	}
    }
</script>
{% endblock %}